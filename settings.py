import math

#map
_ = False

mini_map = [
    [
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, 1, 1, 1, 1, _, _, _, 1, 1, 1, _, _, 1, 1, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, 1, _, _, _, _, _, 1, _, _, _, 1, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, _, _, _, 1, _, _, _, _, _, 1, _, _, 1, 1, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, 1, 1, 1, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, 1, _, _, 1],
        [1, _, _, 1, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, 1, _, _, 1],
        [1, _, _, 1, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, 1, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, 1, 1, 1, 1, _, _, _, 1, _, 1, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, 1, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, 1, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, 1, 1, 1, 1, _, _, _, 1, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, 1],
        [1, _, _, 1, 1, 1, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, 1, 1, _, _, _, _, 1, _, _, 1, 1, _, 1, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, 1, 1, _, _, _, _, 1, _, _, 1, 1, _, 1, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, 1, _, _, _, 1, 1, 1, _, _, 1, 1, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, 1, _, _, _, _, _, 1, _, _, _, 1, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, 1, 1, _, _, _, _, 1, _, _, 1, 1, _, _, _, _, _, _, _, _, 1],
        [1, _, _, 1, 1, 1, 1, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, 1],
        [1, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, 1, _, _, _, 1, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, 1, _, _, _, 1, _, _, _, _, _, 1, _, _, _, _, _, _, _, 1, _, _, _, 1],
        [1, _, _, _, 1, _, _, _, _, _, _, _, _, 1, _, _, 1, _, _, _, 1, 1, _, _, _, 1],
        [1, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, 1, _, _, _, _, _, _, _, 1, 1, 1, 1, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, 1, _, 1, 1, _, 1, 1, 1, 1, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    ],
    [
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, 1, 1, 1, 1, _, _, _, _, 1, 1, _, _, 1, 1, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, 1, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, 1, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, 1, 1, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, 1, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, 1, 1, 1, 1, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, 1, 1, 1, 1, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, 1, 1, 1, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, 1, 1, _, _, _, _, 1, _, _, 1, 1, _, 1, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, 1, _, _, 1, 1, _, 1, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, 1, _, _, _, _, _, 1, _, _, 1, 1, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, 1, _, _, _, _, _, 1, _, _, _, 1, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, 1, 1, _, _, _, _, 1, _, _, 1, 1, _, _, _, _, _, _, _, _, 1],
        [1, _, _, 1, 1, 1, 1, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, 1, _, _, _, 1, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, 1, _, _, _, 1, _, _, _, _, _, 1, _, _, _, _, _, _, _, 1, _, _, _, 1],
        [1, _, _, _, 1, _, _, _, _, _, _, _, _, 1, _, _, 1, _, _, _, 1, 1, _, _, _, 1],
        [1, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, 1, _, _, _, _, _, _, _, 1, 1, 1, 1, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, _, _, 1, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    ],
        [
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, 1, 1, 1, _, _, _, _, _, 1, _, _, 1, 1, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, 1, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, 1, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, 1, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, 1, 1, 1, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1, 1, _, 1, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, 1, _, _, 1, 1, _, 1, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, 1, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, 1, _, _, _, _, 1, _, _, _, 1, _, _, _, _, _, _, _, _, _],
        [_, _, _, 1, 1, 1, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, 1, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, 1, _, _, _, _, _, 1, _, _, _, _, _, _, _, 1, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1, _, _, _, 1, 1, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
        [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
    ],
]

# game settings
RES = WIDTH, HEIGHT = 1600, 900
HALF_WIDTH = WIDTH // 2
HALF_HEIGHT = HEIGHT // 2
FPS = 0
WALL_PIXELS = WIDTH // len(mini_map[0][0])

PLAYER_POS = 0.75, 1.5, 5 # mini_map
PLAYER_HORZONTAL_ANGLE = 0
PLAYER_VERTIAL_ANGLE = math.pi / 2
PLAYER_SPEED = 0.004
PLAYER_ROT_SPEED = 0.002
MIN_VER_ANGLE = math.pi / 6
MAX_VER_ANGLE = MIN_VER_ANGLE + (2 * math.pi) / 3

# horizontal fov
HORIZONTAL_FOV = math.pi / 3
HALF_HORIZONTAL_FOV = HORIZONTAL_FOV / 2
HORIZONTAL_NUM_OF_RAYS = WIDTH // 3
HALF_HORIZONTAL_NUM_OF_RAYS = HORIZONTAL_NUM_OF_RAYS // 2
HORIZONTAL_DELTA_ANGLE = HORIZONTAL_FOV / HORIZONTAL_NUM_OF_RAYS

# vertical fov
VERTICAL_FOV = math.pi / 3
HALF_VERTICAL_FOV = VERTICAL_FOV / 2
VERTICAL_NUM_OF_RAYS = HEIGHT // 5
HALF_VERTICAL_NUM_OF_RAYS = VERTICAL_NUM_OF_RAYS // 2
VERTICAL_DELTA_ANGLE = VERTICAL_FOV / HALF_VERTICAL_NUM_OF_RAYS

MAX_DEPTH = len(mini_map[0][0])
CROSS = len(mini_map)

SCREEN_DIST = HALF_WIDTH / math.tan(HALF_HORIZONTAL_FOV)
SCALE = WIDTH // HORIZONTAL_NUM_OF_RAYS